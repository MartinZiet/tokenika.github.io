

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial Getting Started With Contracts &mdash; Teos python 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="Teos python 1.0 documentation" href="index.html" />
    <link rel="next" title="Teos python" href="teos_python.html" />
    <link rel="prev" title="Example “Currency” Contract Walkthrough" href="currency_walkthrough.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="teos_python.html" title="Teos python"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="currency_walkthrough.html" title="Example “Currency” Contract Walkthrough"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Teos python 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial Getting Started With Contracts</a><ul>
<li><a class="reference internal" href="#getting-started-with-contracts">Getting Started with Contracts</a></li>
<li><a class="reference internal" href="#starting-a-private-blockchain">Starting a Private Blockchain</a></li>
<li><a class="reference internal" href="#creating-a-wallet">Creating a Wallet</a></li>
<li><a class="reference internal" href="#the-eosio-account-and-the-bios-contract">The Eosio Account and the Bios Contract</a></li>
<li><a class="reference internal" href="#creating-accounts">Creating Accounts</a><ul>
<li><a class="reference internal" href="#create-two-user-accounts">Create Two User Accounts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="currency_walkthrough.html"
                        title="previous chapter">Example &#8220;Currency&#8221; Contract Walkthrough</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="teos_python.html"
                        title="next chapter">Teos python</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial_getting_with_contracts.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-getting-started-with-contracts">
<span id="tutorial-getting-started-with-contracts"></span><h1>Tutorial Getting Started With Contracts<a class="headerlink" href="#tutorial-getting-started-with-contracts" title="Permalink to this headline">¶</a></h1>
<p>We rephrase an <a class="reference external" href="#https://github.com/EOSIO/eos/wiki/Tutorial-Getting-Started-With-Contracts">article</a> from EOSIO wiki.</p>
<div class="section" id="getting-started-with-contracts">
<span id="getting-started-with-contracts"></span><h2>Getting Started with Contracts<a class="headerlink" href="#getting-started-with-contracts" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this tutorial is to demonstrate how to setup a local blockchain that can be used to experiment with smart contracts. The first part of this tutorial will focus on:</p>
<ul class="simple">
<li>Starting a Private Blockchain</li>
<li>Creating a Wallet</li>
<li>Loading the Bios Contract</li>
<li>Creating Accounts</li>
</ul>
<p>The second part of this tutorial will walk you through creating and deploying your own contracts.</p>
<ul class="simple">
<li>eosio.token Contract</li>
<li>Exchange Contract</li>
<li>Hello World Contract</li>
<li>This tutorial assumes that you have installed both EOSIO and Tokenika TEOS, therefore, at first import the Tokenika teos python module:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">teos</span>
<span class="n">teos</span><span class="o">.</span><span class="n">set_verbose</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="starting-a-private-blockchain">
<span id="starting-a-private-blockchain"></span><h2>Starting a Private Blockchain<a class="headerlink" href="#starting-a-private-blockchain" title="Permalink to this headline">¶</a></h2>
<p>Launch an object <code class="docutils literal"><span class="pre">teos.Daemon</span></code> that implements interaction with the local EOSIO node. Method <code class="docutils literal"><span class="pre">clear</span></code> starts this node cleared of any past background:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">daemon</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Daemon</span><span class="p">()</span>
<span class="n">daemon</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="c1">#       nodeos exe file: /mnt/e/Workspaces/EOS/eos/build/programs/nodeos/nodeos</span>
<span class="c1">#    genesis state file: /mnt/e/Workspaces/EOS/eos/build/programs/daemon/data-dir/genesis.json</span>
<span class="c1">#        server address: 127.0.0.1:8888</span>
<span class="c1">#      config directory: /mnt/e/Workspaces/EOS/eos/build/programs/daemon/data-dir</span>
<span class="c1">#      wallet directory: /mnt/e/Workspaces/EOS/eos/build/programs/daemon/data-dir/wallet</span>
<span class="c1">#     head block number: 2</span>
<span class="c1">#       head block time: 2018-04-10T17:20:54</span>
</pre></div>
</div>
<p>Now, a newly started terminal has the local node running.</p>
</div>
<div class="section" id="creating-a-wallet">
<span id="creating-a-wallet"></span><h2>Creating a Wallet<a class="headerlink" href="#creating-a-wallet" title="Permalink to this headline">¶</a></h2>
<p>A wallet is a repository of private keys necessary to authorize actions on the blockchain. These keys are stored on disk encrypted using a password generated by the EOSIO node.</p>
<p>Launch an object <code class="docutils literal"><span class="pre">teos.Wallet</span></code> that implements a local wallet:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wallet</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Wallet</span><span class="p">()</span>
<span class="c1">#              password: PW5KLhcjMHeLxiyyrFU8EWncXUHHLNWgw7uxmvKMwMC19jMHR6zWk</span>
<span class="c1">#  You need to save this password to be able to lock/unlock the wallet!</span>
</pre></div>
</div>
<p>The wallet name argument is not set here: it defaults to &#8216;default&#8217;.</p>
<p>When doing with a real value, this password should be stored in a secure password manager, however, for the purpose of development environment, the password is kept in the wallet object. Therefore, the following instructions make sense:</p>
<div class="highlight-python"><div class="highlight"><pre>wallet.lock()
wallet.list()
#                wallet: default
wallet.unlock()
&gt;&gt;&gt; wallet.list()          # The starlet marks unlocked:
#                wallet: default *
</pre></div>
</div>
</div>
<div class="section" id="the-eosio-account-and-the-bios-contract">
<span id="the-eosio-account-and-the-bios-contract"></span><h2>The Eosio Account and the Bios Contract<a class="headerlink" href="#the-eosio-account-and-the-bios-contract" title="Permalink to this headline">¶</a></h2>
<p>You have to owe an valid EOSIO account to be authorized to interact with EOSIO. For tests, you can use the ‘eosio’ account:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">account_eosio</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">EosioAccount</span><span class="p">()</span>
<span class="n">account_eosio</span><span class="o">.</span><span class="n">key_private</span>
<span class="s1">&#39;5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3&#39;</span>
</pre></div>
</div>
<p>You have to have the private key to your property in your wallet. Perhaps, it is there already:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wallet</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="c1">#  {</span>
<span class="c1">#      &quot;wallet keys&quot;: [</span>
<span class="c1">#          [</span>
<span class="c1">#              &quot;EOS6MRyAjQq8ud7hVNYcfnVPJqcVpscN5So8BhtHuGYqET5GDW5CV&quot;,</span>
<span class="c1">#              &quot;5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3&quot;</span>
<span class="c1">#          ]</span>
<span class="c1">#      ]</span>
<span class="c1">#  }</span>
</pre></div>
</div>
<p>Indeed, your wallet contains the key to <code class="docutils literal"><span class="pre">account_eosio</span></code>. I it was not there, you could import it. Now, the following attempt is rejected:</p>
<div class="highlight-python"><div class="highlight"><pre>wallet.import_key(account_eosio)
ERROR! status code is 500  eosd response is Content-Length: 234  Content-type:
application/json  Server: WebSocket++/0.7.0    {&quot;code&quot;:500,&quot;message&quot;:&quot;Internal
Service Error&quot;,&quot;error&quot;:{&quot;code&quot;:10,&quot;name&quot;:&quot;assert_exception&quot;,&quot;what&quot;:&quot;Assert
Exception&quot;,&quot;details&quot;:[{&quot;message&quot;:&quot;!\&quot;Key already in wallet\&quot;:
&quot;,&quot;file&quot;:&quot;wallet.cpp&quot;,&quot;line_number&quot;:150,&quot;method&quot;:&quot;import_key&quot;}]}}
</pre></div>
</div>
<p>Now that you have a wallet with the key for the eosio account loaded, you can set a <em>default system contract</em>. For the purposes of development, the default <code class="docutils literal"><span class="pre">eosio.bios</span></code> contract can be used. This contract enables you to have direct control over the resource allocation of other accounts and to access other privileged API calls. In a public blockchain, this contract will manage the staking and unstaking of tokens to reserve bandwidth for CPU and network activity, and memory for contracts.</p>
<p>The eosio.bios contract can be found in the contracts/eosio.bios folder of your EOSIO source code. The Tokenika teos python is configured to find the proper path.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">contract_eosio_bios</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">SetContract</span><span class="p">(</span>
  <span class="n">account_eosio</span><span class="p">,</span> <span class="s2">&quot;eosio.bios&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="o">=</span><span class="n">account_eosio</span><span class="p">)</span>
<span class="c1">#        transaction id: fd45de61bd9f05a570df44faf5fd4db182f6a4f4d4da3b0302735f23645f63d2</span>
</pre></div>
</div>
<p>The transaction is authorized and signed by <code class="docutils literal"><span class="pre">account_eosio</span></code>.</p>
<p>As the set contract command call has produced the transaction id, the default contract is operational. The result of this transaction setting is that it is generated a transaction with two actions, eosio::setcode and eosio::setabi.</p>
<p>The contract is set to the node in two parts: <code class="docutils literal"><span class="pre">code</span></code> and <code class="docutils literal"><span class="pre">abi</span></code> The code defines how the contract runs and the abi describes how to convert between binary and json representations of the arguments. While an abi is technically optional, all of the EOSIO tooling depends upon it for ease of use.</p>
</div>
<div class="section" id="creating-accounts">
<span id="creating-accounts"></span><h2>Creating Accounts<a class="headerlink" href="#creating-accounts" title="Permalink to this headline">¶</a></h2>
<p>Now that we have setup the basic system contract, we can start to create our own accounts. We will create two accounts, user and tester, and we will need to associate a key with each account. In this example, the same key will be used for both accounts.</p>
<p>To do this we first generate a key for the accounts and import it to the wallet.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">key_accounts</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">CreateKey</span><span class="p">(</span><span class="s2">&quot;key_accounts&quot;</span><span class="p">)</span>
<span class="c1">#              key name: key_accounts</span>
<span class="c1">#           private key: 5JG3gEsowhnQXEYD1z4Vmh2iJMnNrb8oSg9TBVbLFjV7dSuDTrW</span>
<span class="c1">#            public key: EOS4vA5JV7zKTJCa83LHrvzbHv4z6G5g6GLXMgSB3JZQu5rDpRueS</span>

<span class="n">wallet</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">key_accounts</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="create-two-user-accounts">
<span id="create-two-user-accounts"></span><h3>Create Two User Accounts<a class="headerlink" href="#create-two-user-accounts" title="Permalink to this headline">¶</a></h3>
<p>Next we will create two accounts, user and tester, using the key we created and imported above.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">account_user</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Account</span><span class="p">(</span><span class="n">account_eosio</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">)</span>
<span class="c1">#        transaction id: f94c26662da514fac7027270531e023a6fc8cd4dcd739dc67e...</span>

<span class="n">account_tester</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Account</span><span class="p">(</span>
   <span class="n">account_eosio</span><span class="p">,</span> <span class="s2">&quot;tester&quot;</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">)</span>
   <span class="c1">#        transaction id: 6eb3e7a64ac2265de855f9c8b0c5677848e8451b4d6dda8...</span>
</pre></div>
</div>
<p>NOTE: The create account subcommand requires two keys, one for the OwnerKey (which in a production environment should be kept highly secure) and one for the ActiveKey. In this tutorial example, the same key is used for both.</p>
<p>We can query all accounts that are controlled <code class="docutils literal"><span class="pre">key_accounts</span></code> key:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">teos</span><span class="o">.</span><span class="n">GetAccounts</span><span class="p">(</span><span class="n">key_accounts</span><span class="p">)</span>
<span class="c1">#  {</span>
<span class="c1">#      &quot;account_names&quot;: [</span>
<span class="c1">#          &quot;tester&quot;,</span>
<span class="c1">#          &quot;user&quot;</span>
<span class="c1">#      ]</span>
<span class="c1">#  }</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="summary">
<span id="summary"></span><h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">daemon</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Daemon</span><span class="p">()</span>
<span class="n">daemon</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">wallet</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Wallet</span><span class="p">()</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">account_eosio</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">EosioAccount</span><span class="p">()</span>
<span class="n">account_eosio</span><span class="o">.</span><span class="n">key_private</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">account_eosio</span><span class="p">)</span>
<span class="n">key_accounts</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">CreateKey</span><span class="p">(</span><span class="s2">&quot;key_accounts&quot;</span><span class="p">)</span>
<span class="n">wallet</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">key_accounts</span><span class="p">)</span>
<span class="n">account_user</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Account</span><span class="p">(</span>
   <span class="n">account_eosio</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">)</span>
<span class="n">account_tester</span> <span class="o">=</span> <span class="n">teos</span><span class="o">.</span><span class="n">Account</span><span class="p">(</span>
   <span class="n">account_eosio</span><span class="p">,</span> <span class="s2">&quot;tester&quot;</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">,</span> <span class="n">key_accounts</span><span class="p">)</span> 
<span class="n">teos</span><span class="o">.</span><span class="n">GetAccounts</span><span class="p">(</span><span class="n">key_accounts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="teos_python.html" title="Teos python"
             >next</a> |</li>
        <li class="right" >
          <a href="currency_walkthrough.html" title="Example “Currency” Contract Walkthrough"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Teos python 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2018, Tokenika.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>